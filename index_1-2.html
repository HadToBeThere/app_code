<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Had to Be There ‚Äî MVP+ Subs + PotW</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="app.css?v=20251104-10" />
</head>
<body>

  <!-- Splash (Press Start) -->
  <div id="splash" aria-modal="true" role="dialog">
    <div class="splash-wrap">
      <div class="apptitle">Had to Be There</div>
      <div class="bigq">What‚Äôs Happening Now?</div>
      <div class="logo-stack">
        <!-- Pin logo (purely decorative) -->
        <svg class="logo-pin" width="120" height="120" viewBox="0 0 100 100" aria-hidden="true">
          <defs>
            <linearGradient id="pinGrad" x1="0%" x2="0%" y1="0%" y2="100%">
              <stop offset="0%" stop-color="#fca5a5"/>
              <stop offset="100%" stop-color="#b91c1c"/>
            </linearGradient>
          </defs>
          <path d="M50 10c17 0 30 13 30 30 0 22-30 50-30 50S20 62 20 40c0-17 13-30 30-30z" fill="url(#pinGrad)"/>
          <circle cx="50" cy="40" r="9" fill="#fff"/>
        </svg>
        <!-- Globe Start Button -->
        <button id="startGlobe" class="logo-globe" aria-label="Press Start">
          <svg viewBox="0 0 200 200" width="160" height="160" aria-hidden="true">
            <defs>
              <radialGradient id="globeGrad" cx="50%" cy="45%" r="60%">
                <stop offset="0%"  stop-color="#9be8ff"/>
                <stop offset="100%" stop-color="#1d4ed8"/>
              </radialGradient>
            </defs>
            <circle cx="100" cy="100" r="78" fill="url(#globeGrad)" stroke="rgba(0,0,0,.25)" stroke-width="6"/>
            <!-- tiny land blobs -->
            <path d="M70 95c-10-8-8-22 6-28 16-8 30-3 34 10" fill="#10b981" opacity=".95"/>
            <path d="M120 120c8 6 19 5 24-2 7-9 5-21-7-26" fill="#10b981" opacity=".95"/>
          </svg>
          <div class="start-label">PRESS START</div>
        </button>
      </div>
      <div class="tagline">Ephemeral, hyper-local pings that vanish in 24h</div>
      
    </div>
  </div>

  <div id="app" class="prestart-scale">
    <div id="map"><div class="desat-hole"></div></div>

    <!-- Left sidebar (Filters only) -->
    <aside class="leftbar" id="leftbar" aria-label="Filters">
      <div class="section">
        <div><strong>Filter</strong></div>
        <div class="seg" id="filterSeg" style="margin-top:6px">
          <button data-mode="all" class="active">All</button>
          <button data-mode="friends">Friends+Me</button>
          <button data-mode="me">Me</button>
        </div>
        <div style="margin-top:8px"><strong>Time</strong></div>
        <div class="seg" id="timeSeg" style="margin-top:6px; flex-wrap:wrap">
          <button data-time="any" class="active">Any</button>
          <button data-time="30m">30m</button>
          <button data-time="2h">2h</button>
          <button data-time="8h">8h</button>
          <button data-time="24h">24h</button>
        </div>
      </div>
    </aside>

    

    <!-- Top center tray -->
    <div class="tray">
      <span class="pill" id="quotaText">0/3 pings today</span>
    </div>

    <!-- Right: notifications, ledger & profile -->
    <div class="bell-wrapper">
      <button class="bell" id="bellBtn">üîî</button>
      <span class="badge-under" id="notifBadge" style="display:none">0</span>
    </div>
    <button class="bell" id="ledgerBtn" title="PP activity log">üßæ</button>

    <!-- Top-right Sign in (visible when signed out) -->
    <button class="signin-top" id="signInTop">Sign in</button>

    <!-- Profile widget (avatar + name) -->
    <button class="profile-widget" id="profileWidget" aria-label="Profile">
      <div class="profile-avatar" id="profileAvatar" aria-hidden="true"></div>
      <div class="profile-name" id="profileName">Sign in</div>
    </button>

    <!-- Add Ping FAB -->
    <button class="fab" id="addBtn">+ Ping</button>

    <!-- Address Search (above legend) -->
    <div class="address-search" id="addressSearch" style="display:none">
      <input type="text" id="addressInput" placeholder="Search address..." autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" />
      <div class="address-suggestions" id="addressSuggestions" style="display:none"></div>
    </div>

    <!-- Legend -->
    <div class="legend">
      <strong>Had to Be There</strong><br/>
      Ephemeral, hyper-local social moments. Share what's happening right now within your circle ‚Äî no real names, no harassment. Every ping vanishes after 24 hours, keeping it fresh and in-the-moment.
    </div>

    <!-- Hall of Fame Button -->
    <button class="btn" id="hallOfFameBtn" title="Hall of Fame" style="position:fixed;left:50%;transform:translateX(-50%);bottom:90px;z-index:2000;background:#fff;border:1px solid var(--gold);border-radius:10px;padding:5px 10px;font-weight:900;box-shadow:0 6px 18px rgba(0,0,0,.08);display:flex;align-items:center;justify-content:center;gap:5px;color:var(--gold);width:min(420px,88vw);font-size:10px;">
      üèÜ Hall of Fame
    </button>

    <!-- Ping of the Week card -->
    <div id="potwCard" class="potw-card" role="region" aria-live="polite">
      <div class="potw-title" id="potwToggle" style="cursor:pointer;user-select:none">PING OF THE WEEK <span id="potwChevron" style="font-size:10px">&#9660;</span></div>
      <div class="potw-row" id="potwBody">
        <img id="potwImg" alt="Ping of the Week image" style="display:none;"/>
        <div class="potw-body">
          <div class="potw-text" id="potwText"></div>
          <div class="potw-meta muted" id="potwMeta"></div>
          <div class="potw-countdown muted" id="potwCountdown" aria-live="polite"></div>
          <div id="potwEmpty" class="muted">No ping of the week yet.</div>
          <div id="potwThreshold" class="muted" style="display:none; margin-top:2px; font-size:8px;">Need 10 net likes or 5 pings to crown a winner!</div>
          <div id="lastWeekChampion" style="display:none; margin-top:4px; padding:4px 7px; background:#fef3c7; border-radius:5px; border:1px solid #fbbf24;">
            <div style="font-size:8px; font-weight:900; color:#92400e; margin-bottom:1px;">LAST WEEK'S CHAMPION</div>
            <div id="lastWeekText" style="font-size:10px; font-weight:800; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;"></div>
            <div id="lastWeekMeta" class="muted" style="font-size:8px; margin-top:1px;"></div>
          </div>
        </div>
        <div class="potw-actions">
          <button class="btn" id="potwJump" disabled>View</button>
        </div>
      </div>
      <!-- Live Leaderboard -->
      <div id="potwLeaderboard" style="display:none;">
        <div style="font-weight:900; font-size:9px; color:var(--gold); margin-bottom:5px; text-align:center;">üèÜ LEADERBOARD</div>
        <div id="leaderboardTop3"></div>
        <div id="leaderboardUser" style="display:none;"></div>
      </div>
    </div>


    <!-- Notifications Modal -->
    <div class="modal" id="notifsModal" aria-modal="true" role="dialog">
      <div class="card">
        <header>
          <span>Notifications</span>
          <button class="btn" id="closeNotifs">Close</button>
        </header>
        <div class="content" id="notifsContent">
          <div class="muted">No notifications</div>
        </div>
      </div>
    </div>

    <!-- Create Ping Modal -->
    <div class="modal" id="createModal" aria-modal="true" role="dialog">
      <div class="card">
        <header>
          <span>Create Ping</span>
          <div style="display:flex; gap:8px">
            <button class="btn" id="cancelCreate">Cancel</button>
          </div>
        </header>
        <div class="content">
          <div class="row" style="gap:.5rem; align-items:center; margin-bottom:6px">
            <label class="btn" for="pingVisibility">Visibility</label>
            <select id="pingVisibility" class="btn" style="min-width:140px">
              <option value="public" selected>Public</option>
              <option value="private">Private (friends only)</option>
            </select>
          </div>
          <div class="row"><input id="pingText" type="text" maxlength="140" placeholder="What‚Äôs happening?" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" /></div>
          <div class="row" style="gap:.5rem; align-items:center">
            <label class="btn" id="attachMediaLabel" for="pingMedia">Attach Media</label>
            <input id="pingMedia" type="file" accept="image/*,video/*" style="display:none" />
          </div>
          <div id="attachPreview" style="display:none; margin-top:8px; position:relative">
            <img id="attachPreviewImg" alt="Preview" style="max-width:100%; height:auto; border-radius:12px; border:1px solid #eee" />
            <button class="btn icon-btn" id="removeAttachBtn" aria-label="Remove image" title="Remove image" style="position:absolute;top:6px;right:6px">‚úï</button>
          </div>
          <div id="attachVideoPreview" style="display:none; margin-top:8px; position:relative">
            <video id="attachPreviewVid" style="max-width:100%; height:auto; border-radius:12px; border:1px solid #eee" controls muted playsinline></video>
            <button class="btn icon-btn" id="removeVideoBtn" aria-label="Remove video" title="Remove video" style="position:absolute;top:6px;right:6px">‚úï</button>
          </div>
          <input id="lat" type="hidden" />
          <input id="lon" type="hidden" />
        </div>
        <div class="actions">
          <div style="display:flex; gap:8px; align-items:center; width:100%; justify-content:space-between">
            <div class="seg" id="ttlSeg">
              <button data-ttl="2">2h</button>
              <button data-ttl="12">12h</button>
              <button data-ttl="24" class="active">24h</button>
            </div>
            <button class="btn primary" id="submitPing" type="button">Ping</button>
          </div>
        </div>
      </div>
    </div>

    

    <!-- Ping Sheet (details) -->
    <div class="sheet" id="pingSheet" role="dialog" aria-modal="true">
      <header>
        <div style="font-weight:900" id="pingSheetTitle">Ping</div>
        <div style="display:flex; gap:8px">
          <button class="btn" id="openInMapsBtn" title="Open directions" style="display:none">Open in Maps</button>
          <button class="btn report-btn" id="reportBtn">Report</button>
          <button class="btn" id="deletePingBtn" style="display:none">Delete</button>
          <button class="btn" id="closeSheet">Close</button>
        </div>
      </header>
      <div class="author-row" id="authorRow" style="display:flex;align-items:center;gap:10px;padding:10px 14px;border-bottom:1px solid #eee;cursor:pointer">
        <div class="profile-avatar small" id="authorAvatar"></div>
        <div style="flex:1">
          <div id="authorNameLine" style="font-weight:900"></div>
          <div id="authorStatsLine" class="muted" style="font-size:12px"></div>
        </div>
        <button class="btn" id="authorAddFriendBtn" style="display:none">Add Friend</button>
      </div>
      <div class="text" id="sheetText">‚Ä¶</div>
      <div style="padding:10px 14px"><button class="btn" id="viewMediaBtn" style="display:none">View media</button></div>
      <div class="image" id="sheetImage" style="display:none"><img id="sheetImgEl" src="" alt="Ping image"/></div>
      
      <div class="video" id="sheetVideo" style="display:none"><video id="sheetVidEl" src="" controls playsinline style="max-width:100%"></video></div>
      <div class="meta" id="sheetMeta">‚Äî</div>
      <div class="reactbar" id="reactBar"></div>
      <div class="comments" id="comments"></div>
      <div class="comment-input" style="display:flex; gap:8px; padding:10px 14px; border-top:1px solid #eee;">
        <input id="commentInput" type="text" maxlength="200" placeholder="Add a comment" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" />
        <button class="btn" id="sendComment">Send</button>
      </div>
    </div>

    <!-- Sign-in Modal (Google-only) -->
    <div class="modal" id="signInModal" aria-modal="true" role="dialog">
      <div class="card">
        <header>
          <span>Sign in</span>
          <button class="btn" id="closeSignIn">Close</button>
        </header>
        <div class="content">
          <div class="row" style="justify-content:center">
            <button class="btn" id="doGoogle">Sign in with Google</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Modal -->
    <div class="modal" id="profileModal" aria-modal="true" role="dialog">
      <div class="card">
        <header>
          <span id="profileModalTitle">Profile</span>
          <div style="display:flex; gap:8px; align-items:center">
            <button class="btn icon-btn" id="backToProfile" style="display:none">‚Üê</button>
            <button class="btn icon-btn" id="openSettings" title="Settings" style="display:none">‚öôÔ∏é</button>
            <button class="btn icon-btn" id="openStore" title="Buy PPs / Subscribe" style="display:none">$</button>
            <button class="btn" id="openGift">Gift PPs</button>
            <button class="btn" id="closeProfile">Close</button>
          </div>
        </header>
        <div class="content" id="profileContent">
          <div id="ownProfileSection">
            <div class="row" style="gap:12px; align-items:center">
              <div class="profile-avatar large" id="ownProfileAvatar"></div>
              <div style="flex:1">
                <div id="ownStatsLine" class="muted" style="margin-top:6px"></div>
                <div class="muted" id="emailDisplay" style="margin-top:6px"></div>
              </div>
            </div>
            <div class="section" style="margin-top:12px">
              <div><strong>Add Friend</strong></div>
              <div class="row" style="gap:.5rem; margin-top:6px">
                <input id="addFriendInputProfile" type="text" placeholder="username or email" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" />
                <button class="btn" id="addFriendBtnProfile">Add</button>
              </div>
            </div>
            <div class="section" style="margin-top:12px">
              <div><strong>Requests</strong></div>
              <div id="requestsList" style="margin-top:6px">
                <div class="muted">No pending requests.</div>
              </div>
            </div>
            <div class="section" style="margin-top:12px">
              <div><strong>Friends</strong></div>
              <div id="profileFriendsList" style="margin-top:6px">
                <div class="muted">No friends yet.</div>
              </div>
            </div>
            <div class="section" style="margin-top:12px">
              <div style="display:flex;align-items:center;justify-content:space-between">
                <strong>My Pings</strong>
                <button class="btn" id="toggleMyPings" style="font-size:11px;padding:2px 8px">Show</button>
              </div>
              <div id="myPingsList" style="margin-top:6px;display:none">
                <div class="muted">No pings yet.</div>
              </div>
            </div>
          </div>
          <div id="otherProfileSection" style="display:none">
            <div class="row" style="gap:12px; align-items:center">
              <div class="profile-avatar large" id="otherProfileAvatar"></div>
              <div>
                <div style="font-weight:900" id="otherProfileName">Friend</div>
                <div id="otherStatsLine" class="muted" style="margin-top:6px"></div>
              </div>
            </div>
          </div>
          <div id="settingsSection" style="display:none">
            <div class="section">
              <div class="row" style="gap:.5rem; margin-top:6px; align-items:center">
                <div class="profile-avatar large" id="settingsProfileAvatar" style="width:48px;height:48px;"></div>
                <label class="btn" for="settingsImageInput">Change profile pic</label>
                <input id="settingsImageInput" type="file" accept="image/*" style="position:fixed;left:-9999px;top:0;opacity:0" />
              </div>
            </div>
            <div class="section">
              <div><strong>Username</strong></div>
              <div class="row" style="gap:.5rem; margin-top:6px">
                <input id="handleInput" type="text" placeholder="username" />
                <button class="btn" id="saveHandle">Save username</button>
              </div>
              <div id="handleCooldownHint" class="muted" style="margin-top:6px;font-size:12px"></div>
            </div>
            <div class="section" id="customPingSection" style="margin-top:12px">
              <div><strong>Custom Ping</strong></div>
              <div id="customPingOptions" class="row" style="flex-direction:column; gap:8px; margin-top:8px"></div>
              <input id="customPingInput" type="file" accept="image/*" style="position:fixed;left:-9999px;top:0;opacity:0" />
            </div>
          </div>
        </div>
        <div class="actions" id="profileActions" style="justify-content:flex-end">
          <button class="btn" id="signOutInProfile" style="display:none">Sign out</button>
        </div>
      </div>
    </div>

    <!-- Image Lightbox -->
    <div class="modal" id="imageLightbox" aria-modal="true" role="dialog">
      <div class="card" style="max-width:min(90vw,900px)">
        <header>
          <span>Image</span>
          <button class="btn" id="closeLightbox">Close</button>
        </header>
        <div class="content" style="display:flex; justify-content:center">
          <img id="lightboxImg" alt="Image" style="max-width:100%; height:auto; image-rendering:auto; border-radius:12px; border:1px solid #eee" />
        </div>
        <div class="content" style="padding-top:0"><div class="muted" id="imageByline" style="font-size:12px"></div></div>
      </div>
    </div>

    <!-- Video Lightbox -->
    <div class="modal" id="videoLightbox" aria-modal="true" role="dialog">
      <div class="card" style="max-width:min(90vw,900px)">
        <header>
          <span>Video</span>
          <button class="btn" id="closeVideoLightbox">Close</button>
        </header>
        <div class="content" style="display:flex; justify-content:center; align-items:center">
          <video id="lightboxVideo" controls playsinline style="max-width:100%; max-height:70vh; width:auto; height:auto; object-fit:contain; border-radius:12px; border:1px solid #eee"></video>
        </div>
        <div class="content" style="padding-top:0"><div class="muted" id="videoByline" style="font-size:12px"></div></div>
      </div>
    </div>

    <!-- Pin Preview Modal -->
    <div class="modal" id="pinPreviewModal" aria-modal="true" role="dialog">
      <div class="card" style="max-width:min(92vw,760px)">
        <header>
          <span>Pin preview</span>
          <button class="btn" id="closePinPreview">Close</button>
        </header>
        <div class="content" style="display:flex; justify-content:center; align-items:center">
          <div id="pinPreviewBig" style="display:flex; align-items:center; justify-content:center; width:100%; height:640px"></div>
        </div>
      </div>
    </div>

    <!-- Avatar Crop Modal -->
    <div class="modal" id="cropModal" aria-modal="true" role="dialog">
      <div class="card">
        <header>
          <span>Adjust profile photo</span>
          <button class="btn" id="closeCrop">Cancel</button>
        </header>
        <div class="content">
          <div id="cropFrame" style="width:min(320px,80vw);height:min(320px,80vw);margin:0 auto;position:relative;border-radius:50%;overflow:hidden;border:1px solid #eee;box-shadow:inset 0 0 0 200vmax rgba(0,0,0,.25);">
            <img id="cropImage" alt="Crop" style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) scale(1);user-select:none;touch-action:none;will-change:transform" />
          </div>
          <div class="row" style="gap:8px;align-items:center;justify-content:center;margin-top:10px">
            <input type="range" id="cropZoom" min="1" max="3" step="0.01" value="1" style="width:min(320px,80vw)" />
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" id="saveCroppedAvatar">Save</button>
        </div>
      </div>
    </div>

    <!-- Ping Image Crop Modal (pin-shaped) -->
    <div class="modal" id="pingCropModal" aria-modal="true" role="dialog">
      <div class="card">
        <header>
          <span>Adjust ping image</span>
          <button class="btn" id="closePingCrop">Cancel</button>
        </header>
        <div class="content">
          <div id="pingCropFrame" style="width:min(320px,80vw);height:min(420px,90vw);margin:0 auto;position:relative;overflow:hidden;border:1px solid #eee;box-shadow:inset 0 0 0 200vmax rgba(0,0,0,.25);">
            <img id="pingCropImage" alt="Ping Crop" style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) scale(1);user-select:none;touch-action:none;will-change:transform" />
            <div id="pingCropOverlay" aria-hidden="true" style="position:absolute;inset:0;pointer-events:none"></div>
          </div>
          <div class="row" style="gap:8px;align-items:center;justify-content:center;margin-top:10px">
            <input type="range" id="pingCropZoom" min="0.2" max="5" step="0.01" value="1" style="width:min(320px,80vw)" />
          </div>
          <div class="row" style="gap:8px;align-items:center;justify-content:center;margin-top:10px">
            <canvas id="pingPreview" width="120" height="160" style="border:1px solid #eee;border-radius:12px;background:#fff"></canvas>
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" id="savePingCrop">Save</button>
        </div>
      </div>
    </div>

    <!-- Gift Modal -->
    <div class="modal" id="giftModal" aria-modal="true" role="dialog">
      <div class="card">
        <header>
          <span>Gift PPs</span>
          <button class="btn" id="closeGift">Close</button>
        </header>
        <div class="content">
          <div class="row" style="gap:.5rem; align-items:center">
            <input id="giftWho" type="text" placeholder="@username or email" />
            <input id="giftAmt" type="number" placeholder="Amount" min="1" step="1" style="width:140px" />
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" id="sendGift">Gift</button>
        </div>
      </div>
    </div>

    

    <!-- Ledger Modal -->
    <div class="modal" id="ledgerModal" aria-modal="true" role="dialog">
      <div class="card">
        <header>
          <span>PP Activity</span>
          <button class="btn" id="closeLedger">Close</button>
        </header>
        <div class="content" id="ledgerContent"><div class="muted">No activity</div></div>
      </div>
    </div>

    <!-- Report Modal -->
    <div class="modal" id="reportModal" aria-modal="true" role="dialog">
      <div class="card">
        <header>
          <span>Report Content</span>
          <button class="btn" id="closeReport">Close</button>
        </header>
        <div class="content">
          <div class="section">
            <div><strong>Reason</strong></div>
            <div class="row" style="gap:.5rem; margin-top:6px; align-items:center">
              <select id="reportReasonSelect" class="btn" style="flex:1">
                <option value="">Select a reason‚Ä¶</option>
                <option value="harassment">Harassment</option>
                <option value="doxxing">Personal info</option>
                <option value="spam">Spam</option>
                <option value="other">Other</option>
              </select>
            </div>
          </div>
          <div class="section" style="margin-top:12px">
            <div><strong>Additional details (optional)</strong></div>
            <textarea id="reportMessage" maxlength="500" placeholder="Please describe why you're reporting this..." style="margin-top:6px; min-height:100px; resize:vertical"></textarea>
          </div>
        </div>
        <div class="actions">
          <button class="btn primary" id="submitReport">Submit Report</button>
        </div>
      </div>
    </div>

    <!-- Hall of Fame Modal -->
    <div class="modal" id="hallOfFameModal" aria-modal="true" role="dialog">
      <div class="card" style="max-width:min(720px,92vw); max-height:86vh;">
        <header>
          <span>üèÜ Hall of Fame - Ping of the Week Winners</span>
          <button class="btn" id="closeHallOfFame">Close</button>
        </header>
        <div class="content" id="hallOfFameContent">
          <div class="muted" style="text-align:center; padding:20px;">Loading history...</div>
        </div>
      </div>
    </div>

    <!-- Toasts -->
    <div id="toast" role="status" aria-live="polite" aria-atomic="true"></div>
  </div>
    <!-- Store Modal -->
    <div class="modal" id="storeModal" aria-modal="true" role="dialog">
      <div class="card" style="max-width:min(520px,92vw)">
        <header>
          <span>Support</span>
          <button class="btn" id="closeStore">Close</button>
        </header>
        <div class="content">
          <div class="section">
            <div><strong>Buy PPs</strong></div>
            <div class="row" style="gap:8px; flex-wrap:wrap; margin-top:6px" id="ppBundles"></div>
          </div>
          <div class="section" style="margin-top:12px">
            <div><strong>Subscribe</strong></div>
            <div class="row" style="gap:8px; align-items:center; margin-top:6px">
              <div class="muted" style="flex:1">Unlock custom image pings + 100 PPs instantly</div>
              <button class="btn primary" id="subscribeBtn">Subscribe $1.99</button>
            </div>
            <div class="muted" id="subStatus" style="margin-top:6px"></div>
          </div>
        </div>
      </div>
    </div>

  <!-- Leaflet -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- MapLibre GL (optional vector basemap) -->
  <link href="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.js"></script>
  <script src="https://unpkg.com/maplibre-gl-leaflet@0.0.17/leaflet-maplibre-gl.js"></script>

  <!-- Firebase (Compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-functions-compat.js"></script>

  <!-- Enhanced Content Moderation System -->
  <script>
    console.log('üõ°Ô∏è Enhanced content moderation system loading...');
    console.log('üìä Features: 6 skin tone detection algorithms, weighted scoring, 10% threshold');
    console.log('üöÄ No external dependencies - works offline and is more reliable');
  </script>
  
  <!-- Configuration (load before app.js) -->
  <script src="config.js"></script>
  
  <!-- Security & App -->
  <script src="performance-fixes.js?v=20251104-10"></script>
  <script src="mobile-fixes.js?v=20251104-10"></script>
  <script src="xss-protection.js?v=20251104-10"></script>
  <script src="cloud-functions-client.js?v=20251104-10"></script>
  <script src="app.js?v=20251104-10"></script>

  <!-- Mention suggestions popover -->
  <div id="mentionSuggest" class="mention-popover" style="display:none"></div>

</body>
</html>





